<%- include("header") -%>

<form action="/">
<button id="home"><i class="fa fa-home"></i></button>
</form>

<div class="box" id="heading">
    <h1> <%= listTitle %> </h1>
  </div>  

  <div id="textFields">

    <input type="text" id="myInput" onkeyup="myFunction()" placeholder="Search for Names..." title="Type in a Name">
    <input type="text" id="myInputTwo" onkeyup="myFunctionTwo()" placeholder="Search for a Business..." title="Type in a Business">
    <input type="text" id="myInputThree" onkeyup="myFunctionThree()" placeholder="Search for Jobs..." title="Type in a Job">
  
    </div>

  <table id="table">
    <th onclick="sortTable(0)">Name &#x2195;</th>
    <th onclick="sortTable(1)">Business &#x2195;</th>
    <th onclick="sortTable(2)">Phone Number &#x2195;</th>
    <th onclick="sortTable(3)">Occupation &#x2195;</th>
    <th onclick="sortTable(4)">Comments &#x2195;</th>
    <th>Delete</th>
 

<div class="box">
    <% newListContacts.forEach(function(contact){ %>
      <form id="deleteButton" action="/delete" method="post">
        <div class="contact">
          <tr>
          <td><p><%=  contact.name  %></p></td>  
          <td><p><%=  contact.business  %></p></td>
          <td><p><%=  contact.number  %></p></td>
          <td><p><%=  contact.occupation  %></p></td>
          <td><p><%=  contact.comments  %></p></td>
          <td><button type="button" class="fa fa-trash" onClick="if(confirm('Are you sure you want to delete this contact?') === true) {this.form.submit()} else {window.location.href=window.location.href}"><input type="hidden" name="checkbox" value="<%= contact._id %>"></button></td>
          </tr>
        </div>
        <input type="hidden" name="listName" value="<%= listTitle %>"></input>
      </form>
  
    <% }) %>
    
</table>

<h1 class="addText">ADD NEW CONTACT</h1>

<div class="addArea">  
    <form class="contact container-fluid" id="addArea" action="/" method="post">
        <input type="text" name="newName" placeholder="Contact Name" autocomplete="off"><br>
        <input type="text" name="newBusiness" placeholder="Business Name" autocomplete="off"><br>
        <input type="text" name="newNumber" placeholder="Phone Number" autocomplete="off"><br>
        <input type="text" name="newOccupation" placeholder="Occupation" autocomplete="off"><br>
        <input type="text" name="newComments" placeholder="Comments" autocomplete="off"><br>
        <button type="submit" name="list" value="<%= listTitle %>">+</button>
      </form>
</div>
  </div>

  <script>// JavaScript program to illustrate
    // Table sort for both columns and both directions.
    function sortTable(n) {
        let table;
        table = document.getElementById('table');
        let rows,
          i,
          x,
          y,
          count = 0;
        let switching = true;
      
        // Order is set as ascending
        let direction = 'ascending';
      
        // Run loop until no switching is needed
        while (switching) {
          switching = false;
          let rows = table.rows;
      
          //Loop to go through all rows
          for (i = 1; i < rows.length - 1; i++) {
            var Switch = false;
      
            // Fetch 2 elements that need to be compared
            x = rows[i].getElementsByTagName('TD')[n];
            y = rows[i + 1].getElementsByTagName('TD')[n];
      
            // Check the direction of order
            if (direction == 'ascending') {
              // Check if 2 rows need to be switched
              if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                // If yes, mark Switch as needed and break loop
                Switch = true;
                break;
              }
            } else if (direction == 'descending') {
              // Check direction
              if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                // If yes, mark Switch as needed and break loop
                Switch = true;
                break;
              }
            }
          }
          if (Switch) {
            // Function to switch rows and mark switch as completed
            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
            switching = true;
      
            // Increase count for each switch
            count++;
          } else {
            // Run while loop again for descending order
            if (count == 0 && direction == 'ascending') {
              direction = 'descending';
              switching = true;
            }
          }
        }
      }
    function myFunction() {
    var input, filter, table, tr, td, i, txtValue;
    input = document.getElementById("myInput");
    filter = input.value.toUpperCase();
    table = document.getElementById("table");
    tr = table.getElementsByTagName("tr");
    for (i = 0; i < tr.length; i++) {
      td = tr[i].getElementsByTagName("td")[0];
      if (td) {
        txtValue = td.textContent || td.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          tr[i].style.display = "";
        } else {
          tr[i].style.display = "none";
        }
        
      }       
    }
  }
  
  function myFunctionTwo() {
    var input, filter, table, tr, td, i, txtValue;
    input = document.getElementById("myInputTwo");
    filter = input.value.toUpperCase();
    table = document.getElementById("table");
    tr = table.getElementsByTagName("tr");
    for (i = 0; i < tr.length; i++) {
      td = tr[i].getElementsByTagName("td")[1];
      if (td) {
        txtValue = td.textContent || td.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          tr[i].style.display = "";
        } else {
          tr[i].style.display = "none";
        }
        
      }       
    }
    
  }
  function myFunctionThree() {
    var input, filter, table, tr, td, i, txtValue;
    input = document.getElementById("myInputThree");
    filter = input.value.toUpperCase();
    table = document.getElementById("table");
    tr = table.getElementsByTagName("tr");
    for (i = 0; i < tr.length; i++) {
      td = tr[i].getElementsByTagName("td")[3];
      if (td) {
        txtValue = td.textContent || td.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          tr[i].style.display = "";
        } else {
          tr[i].style.display = "none";
        }
        
      }       
    }
  }
  </script>

  <%- include("footer") -%>